<div class="slider-value" style="border: 1px solid grey; border-radius: 10px; padding: 20px;">
  <!-- Range slider for setting the value -->
  <input type="range" min="1000" max="10000" value="1000" step="1000" class="slider" id="slider1">

  <%= form_tag('/devices/switchon', method: 'post') do %>
    <!-- Hidden field for chip_id -->
    <%= hidden_field_tag :chip_id, chip_id %>
    <!-- Hidden field for the slider value -->
    <%= hidden_field_tag :longlast, "", id: 'switchon_message_field' %>
    <%= submit_tag 'KÍCH HOẠT', id: 'publish-button-switchon', class: 'btn btn-primary' %>
  <% end %>
</div>

<script>
  const sliderInput = document.getElementById('slider1');
  const messageField = document.getElementById('switchon_message_field');

  sliderInput.addEventListener('input', () => {
    messageField.value = sliderInput.value;
  });
</script>

<!-- Toggle Switch Form with Grey Border -->
<div style="border: 1px solid grey; border-radius: 10px; padding: 20px; margin-top: 20px;">
  <%= form_tag('/devices/switchon', method: 'post', id: 'toggle-form') do %>
    <!-- Hidden field for chip_id -->
    <%= hidden_field_tag :chip_id, chip_id %>
    <!-- Hidden field for the toggle state as 'switch_value' parameter -->
    <%= hidden_field_tag :switch_value, "0", id: 'toggle_state_field' %>

    <!-- Styled Toggle Switch -->
    <div class="toggle-switch">
      <label class="switch">
        <%= check_box_tag :toggle, "1", false, id: 'toggle-switch' %>
        <span class="slider-round"></span>
      </label>
      <span>ON / OFF</span>
    </div>
  <% end %>
</div>

<script>
  const toggleSwitch = document.getElementById('toggle-switch');
  const toggleStateField = document.getElementById('toggle_state_field');
  const toggleForm = document.getElementById('toggle-form');

  toggleSwitch.addEventListener('change', (event) => {
    // Cập nhật giá trị cho trường ẩn
    toggleStateField.value = toggleSwitch.checked ? '1' : '0';

    // Ngăn chặn hành động gửi form mặc định
    event.preventDefault();

    // Xác nhận hành động gửi form
    const confirmed = confirm("Bạn có chắc chắn muốn gửi không?");
    if (confirmed) {
      toggleForm.submit(); // Gửi form nếu được xác nhận
    } else {
      toggleSwitch.checked = !toggleSwitch.checked; // Khôi phục trạng thái trước đó nếu không được xác nhận
    }
  });
</script>


<!-- Timer Setting Form with Grey Border -->
<div style="border: 1px solid grey; border-radius: 10px; padding: 20px; margin-top: 20px;">
  <%= form_tag('/devices/switchon', method: 'post') do %>
    <!-- Hidden field for chip_id -->
    <%= hidden_field_tag :chip_id, chip_id %>
    
    <!-- Date and Time Input Field -->
    <div class="form-group">
      <label for="start_time">Ngày và giờ hẹn giờ:</label>
      <%= datetime_local_field_tag :start_time, nil, id: 'reminder-start-time', class: 'form-control' %>
    </div>
    
    <!-- Duration Input Field -->
    <div class="form-group">
      <label for="duration">Thời gian hoạt động (phút):</label>
      <%= number_field_tag :duration, nil, id: 'reminder-duration', class: 'form-control', min: 1, step: 1 %>
    </div>

    <!-- Repeat Type Select Field -->
    <div class="form-group">
      <label for="repeat_type">Kiểu lặp lại:</label>
      <%= select_tag :repeat_type, options_for_select([['Không lặp lại', 'none'], ['Hằng ngày', 'daily'], ['Hằng tuần', 'weekly'], ['Hằng tháng', 'monthly']]), id: 'reminder-repeat-type', class: 'form-control' %>
    </div>
    
    <!-- Submit Button for Timer -->
    <br><br>
    <%= submit_tag 'Hẹn giờ', class: 'btn btn-success' %>
  <% end %>
</div>
<br>
<br>
<br>